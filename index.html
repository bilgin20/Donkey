<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Donkey</title>
    <link rel="stylesheet" href="./assets/css/style.css">
    <link rel="stylesheet" href="./assets/css/responsive.css">
    <meta name="theme-color" content="#f19e36" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="icon" type="image/x-icon" href="./assets/favicon/favicon.ico">
    <style>
        .tonconnect-wallet-container {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 10;
        }
    </style>
</head>
<body>

    <!-- TonConnect Wallet Integration (Buton en Ã¼stte) -->
    <div class="tonconnect-wallet-container">
        <button onclick="connectWallet()">CONNECT WALLET</button>
    </div>

    <!-- Coin Count Section -->
    <div class="coin-count-container">
        <img src="./assets/images/hamster.png" width="45px">
        <h1 class="select-none">0</h1>
    </div>

    <div class="rank-container">
        <div class="rank-items">
            <h3 class="select-none"></h3>
            <span></span>
            <img src="./assets/images/hamster.png" class="select-none" width="30px">
            <span id="rank" class="select-none">DonkeyTOKEN</span>
        </div>
    </div>
    
    <div class="coin-container">
        <img src="./assets/images/hamster.png" id="coin" class="select-none" width="300px" />
    </div>

    <!-- Message from the Lord of the Donkey -->
    <div class="message-container">
        <div class="message-content">
            <h2>Message from the Lord of the Donkey:</h2>
            <p>
               Hey Donkey, now it's time to get started, play games, complete missions and make sure Donkey gets the biggest share of the airdrop!
                Each visit per day gives you 1000 extra energy.
            </p>
            <p>
                Airdrop Date: March 2025-April 2025
            </p>
        </div>
    </div>
    
    <div class="menu-container">
        <div class="power">
            <img src="./assets/images/28.png" width="40px">
            <div class="power-count">
                <span id="power" class="select-none">0</span>
                <span class="gray select-none" id="total">/0</span>
            </div>
        </div>
          
        <div class="menu-bottuns">
            <a href="frens.html" class="button b-r">
                <img src="./assets/images/1.png" alt="" width="28px">
                <span class="select-none">friends</span>
            </a>
            <a href="earn.html" class="button b-r">
                <img src="./assets/images/2.png" alt="" width="28px">
                <span class="select-none">tasks</span>
            </a>
            <a href="boost.html" class="button">
                <img src="./assets/images/3.png" alt="" width="28px">
                <span class="select-none">balance</span>
            </a>
        </div>
    </div>

    <div class="progress-bar">
        <div class="progress"></div>
    </div>

    <script src="https://unpkg.com/@tonconnect/sdk@latest/dist/tonconnect-sdk.min.js"></script>
    <script>
        const connector = new TonConnectSDK.TonConnect({
          manifestUrl:
            "https://raw.githubusercontent.com/nuex001/Tonkeepermanifest/main/tonconnect-manifest.json",
        });

        const connectWallet = () => {
          const walletConnectionSource = {
            universalLink: "https://app.tonkeeper.com/ton-connect",
            bridgeUrl: "https://bridge.tonapi.io/bridge",
          };

          const universalLink = connector.connect(walletConnectionSource);
          window.open(universalLink, "_blank");
        };

        connector.onStatusChange((status) => {
          console.log("Connection status changed:", status);
          if (status) {
            const rawAddress = status.account.address;
            // Convert raw address to base64 format
            const apiUrl = `https://toncenter.com/api/v2/packAddress?address=${encodeURIComponent(
              rawAddress
            )}`;
            fetch(apiUrl, {
              method: "GET",
              headers: {
                accept: "application/json",
              },
            })
              .then((response) => response.json())
              .then((data) => {
                if (data.ok) {
                  console.log("Packed Address:", data.result);
                } else {
                  console.error("Error:", data);
                }
              })
              .catch((error) => console.error("Fetch Error:", error));

            // Display the connected wallet address
            document.body.innerHTML += `<p>Connected Wallet Address: ${rawAddress}</p>`;
          }
        });
    </script>

    <script>
        const DAILY_BONUS = 1000;
        const clanButton = document.getElementById('clan');
        const powerElement = document.getElementById('power');

        clanButton.addEventListener('click', () => {
            let power = parseInt(localStorage.getItem('power') || '0');
            power += DAILY_BONUS;
            localStorage.setItem('power', power);
            powerElement.textContent = power;
            alert(`Daily bonus of ${DAILY_BONUS} points added!`);
        });
    </script>
    <script src="./assets/js/main.js"></script>
</body>
</html>
